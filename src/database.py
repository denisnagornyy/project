"""
Модуль инициализации и настройки объекта базы данных SQLAlchemy для Flask-приложения.

Этот модуль выполняет две ключевые задачи:
1.  Создает глобальный экземпляр объекта `SQLAlchemy` (называемый `db`).
    Этот объект будет служить основным интерфейсом для взаимодействия с базой данных
    во всем приложении: определение моделей, выполнение запросов, управление сессиями.
2.  Предоставляет функцию `init_db(app)`, которая связывает (инициализирует)
    этот глобальный объект `db` с конкретным экземпляром Flask-приложения.
    Такой подход (создание `db` глобально, а инициализация позже) является
    стандартным паттерном при использовании Flask-SQLAlchemy и позволяет избежать
    циклических зависимостей, так как модели могут импортировать `db` из этого модуля
    еще до того, как будет создан экземпляр приложения Flask.

Использование Flask-SQLAlchemy значительно упрощает интеграцию мощного ORM SQLAlchemy
с веб-фреймворком Flask, автоматизируя многие аспекты управления сессиями,
конфигурацией подключения и интеграцией с контекстом приложения Flask.
"""

from flask_sqlalchemy import SQLAlchemy

db = SQLAlchemy()

def init_db(app):
    """
    Инициализирует объект базы данных `db` для указанного Flask-приложения.

    Эта функция должна вызываться после создания экземпляра Flask-приложения
    (обычно внутри фабрики приложений `create_app` в `app.py`).
    Она связывает ранее созданный глобальный объект `db` с переданным
    экземпляром `app`, загружая конфигурацию базы данных из `app.config`
    (например, `SQLALCHEMY_DATABASE_URI`, `SQLALCHEMY_TRACK_MODIFICATIONS`)
    и настраивая управление сессиями SQLAlchemy в контексте Flask.

    После вызова этой функции объект `db` становится полностью готовым к использованию
    в рамках данного Flask-приложения (например, для создания таблиц `db.create_all()`
    или для выполнения запросов `db.session.query(...)`).

    Аргументы:
        app (Flask): Экземпляр Flask-приложения, для которого необходимо
                     инициализировать базу данных.
    """

    db.init_app(app)
